
{
  "name": "ai_conversation_record",
  "description": "AI客服对话记录数据模型，存储用户与AI客服的完整对话历史",
  "fields": [
    {
      "name": "conversation_id",
      "type": "string",
      "description": "会话唯一标识符",
      "required": true,
      "index": true
    },
    {
      "name": "user_id",
      "type": "string",
      "description": "用户ID",
      "required": false,
      "index": true
    },
    {
      "name": "session_id",
      "type": "string",
      "description": "会话session ID",
      "required": true,
      "index": true
    },
    {
      "name": "user_message",
      "type": "text",
      "description": "用户消息内容",
      "required": true
    },
    {
      "name": "ai_response",
      "type": "text",
      "description": "AI回复内容",
      "required": true
    },
    {
      "name": "message_type",
      "type": "string",
      "description": "消息类型：user/ai/system",
      "required": true,
      "defaultValue": "user"
    },
    {
      "name": "intent",
      "type": "string",
      "description": "识别的意图类型",
      "required": false
    },
    {
      "name": "emotion",
      "type": "string",
      "description": "情绪标签：positive/neutral/negative/concerned/confused",
      "required": false
    },
    {
      "name": "confidence",
      "type": "number",
      "description": "AI响应置信度 0-1",
      "required": false,
      "defaultValue": 0.8
    },
    {
      "name": "response_time",
      "type": "number",
      "description": "响应时间（秒）",
      "required": false
    },
    {
      "name": "satisfaction_score",
      "type": "number",
      "description": "用户满意度评分 1-5",
      "required": false
    },
    {
      "name": "model_used",
      "type": "string",
      "description": "使用的AI模型",
      "required": false,
      "defaultValue": "gpt-4o"
    },
    {
      "name": "prompt_template",
      "type": "string",
      "description": "使用的Prompt模板ID",
      "required": false
    },
    {
      "name": "tools_called",
      "type": "array",
      "description": "调用的工具列表",
      "required": false,
      "defaultValue": []
    },
    {
      "name": "context_data",
      "type": "object",
      "description": "上下文数据（JSON格式）",
      "required": false,
      "defaultValue": {}
    },
    {
      "name": "source",
      "type": "string",
      "description": "对话来源：web/widget/mobile/api",
      "required": false,
      "defaultValue": "web"
    },
    {
      "name": "language",
      "type": "string",
      "description": "对话语言",
      "required": false,
      "defaultValue": "zh"
    },
    {
      "name": "region",
      "type": "string",
      "description": "用户地区",
      "required": false
    },
    {
      "name": "user_agent",
      "type": "string",
      "description": "用户代理信息",
      "required": false
    },
    {
      "name": "ip_address",
      "type": "string",
      "description": "IP地址",
      "required": false
    },
    {
      "name": "conversion_status",
      "type": "string",
      "description": "转化状态：lead/opportunity/customer/lost",
      "required": false
    },
    {
      "name": "tags",
      "type": "array",
      "description": "对话标签",
      "required": false,
      "defaultValue": []
    },
    {
      "name": "feedback",
      "type": "object",
      "description": "用户反馈信息",
      "required": false,
      "defaultValue": {}
    },
    {
      "name": "status",
      "type": "string",
      "description": "对话状态：active/completed/transferred/abandoned",
      "required": false,
      "defaultValue": "active"
    },
    {
      "name": "priority",
      "type": "number",
      "description": "优先级 1-5",
      "required": false,
      "defaultValue": 3
    },
    {
      "name": "assigned_agent",
      "type": "string",
      "description": "分配的客服人员",
      "required": false
    },
    {
      "name": "escalation_reason",
      "type": "string",
      "description": "升级原因",
      "required": false
    },
    {
      "name": "resolution_time",
      "type": "number",
      "description": "解决时间（秒）",
      "required": false
    },
    {
      "name": "first_response_time",
      "type": "number",
      "description": "首次响应时间（秒）",
      "required": false
    },
    {
      "name": "created_at",
      "type": "datetime",
      "description": "创建时间",
      "required": true,
      "defaultValue": "now"
    },
    {
      "name": "updated_at",
      "type": "datetime",
      "description": "更新时间",
      "required": true,
      "defaultValue": "now"
    }
  ],
  "indexes": [
    {
      "name": "conversation_id_index",
      "fields": ["conversation_id"],
      "unique": false
    },
    {
      "name": "user_id_index", 
      "fields": ["user_id"],
      "unique": false
    },
    {
      "name": "created_at_index",
      "fields": ["created_at"],
      "unique": false
    },
    {
      "name": "intent_index",
      "fields": ["intent"],
      "unique": false
    },
    {
      "name": "emotion_index",
      "fields": ["emotion"],
      "unique": false
    },
    {
      "name": "status_index",
      "fields": ["status"],
      "unique": false
    }
  ]
}
